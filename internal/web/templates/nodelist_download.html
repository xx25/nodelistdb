<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>{{.Title}}</h1>
            <p class="subtitle">Historical FidoNet nodelist files available for download</p>
        </header>
        
        {{template "nav" .}}
        
        <div class="content">
            {{if .Error}}
            <div class="alert alert-danger">
                <strong>Error:</strong> {{.Error}}
            </div>
            {{end}}
            
            {{if .Latest}}
            <div class="card">
                <h2 style="color: var(--text-primary); margin-bottom: 1.5rem;">üì• Latest Nodelist</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Download the most recent nodelist file from our collection.
                </p>
                
                <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius); border-left: 4px solid var(--primary-color);">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                        <div>
                            <strong style="color: var(--text-primary); font-size: 1.1rem;">{{.Latest.Name}}</strong><br>
                            <span style="color: var(--text-secondary);">
                                Date: {{.Latest.Date.Format "January 2, 2006"}} (Day {{.Latest.DayNumber}})
                            </span>
                        </div>
                        <div>
                            <a href="/download/latest" class="btn" style="text-decoration: none;">
                                üì• Download Latest
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-success" style="margin-top: 1.5rem;">
                    <strong>Direct Download URL:</strong> <code>{{.BaseURL}}/download/latest</code><br>
                    <strong>Browse all nodelists:</strong> <code>{{.BaseURL}}/nodelists</code>
                </div>
            </div>
            {{end}}
            
            <div class="card">
                <h2 style="color: var(--text-primary); margin-bottom: 1.5rem;">üìÅ Browse by Year</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Select a year to view available nodelist files.
                </p>
                
                {{if not .Years}}
                <div class="alert alert-danger">
                    No nodelist files found in the configured directory.
                </div>
                {{else}}
                <div style="display: grid; gap: 1rem;">
                    {{range .Years}}
                    <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius); border: 1px solid #e2e8f0;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem;">üìÖ {{.Year}}</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                            {{.Count}} nodelist{{if ne .Count 1}}s{{end}} available
                        </p>
                        
                        <details>
                            <summary style="cursor: pointer; color: var(--primary-color); font-weight: 600; margin-bottom: 1rem;">
                                View Files
                            </summary>
                            
                            <div style="max-height: 300px; overflow-y: auto; margin-top: 1rem;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="border-bottom: 2px solid #e2e8f0;">
                                            <th style="text-align: left; padding: 0.5rem; color: var(--text-primary);">File</th>
                                            <th style="text-align: left; padding: 0.5rem; color: var(--text-primary);">Date</th>
                                            <th style="text-align: left; padding: 0.5rem; color: var(--text-primary);">Day</th>
                                            <th style="text-align: center; padding: 0.5rem; color: var(--text-primary);">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{range .Files}}
                                        <tr style="border-bottom: 1px solid #f1f5f9;">
                                            <td style="padding: 0.5rem; font-family: monospace;">
                                                {{.Name}}
                                            </td>
                                            <td style="padding: 0.5rem; color: var(--text-secondary);">
                                                {{.Date.Format "Jan 02"}}
                                            </td>
                                            <td style="padding: 0.5rem; color: var(--text-secondary);">
                                                {{.DayNumber}}
                                            </td>
                                            <td style="padding: 0.5rem; text-align: center;">
                                                <a href="/download/nodelist/{{.Year}}/{{.Name}}" class="btn btn-sm" style="text-decoration: none; padding: 0.25rem 0.5rem; font-size: 0.875rem;">
                                                    üì• Download
                                                </a>
                                            </td>
                                        </tr>
                                        {{end}}
                                    </tbody>
                                </table>
                            </div>
                        </details>
                    </div>
                    {{end}}
                </div>
                {{end}}
            </div>
            
            <div class="card">
                <h2 style="color: var(--text-primary); margin-bottom: 1.5rem;">üì¶ Bulk Download Options</h2>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Download multiple nodelists at once for archival or mirroring purposes.
                </p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>üìã</h3>
                        <p style="color: var(--text-primary); font-size: 1rem; margin-top: 1rem;">
                            <a href="/download/urls.txt" class="btn" style="text-decoration: none; display: inline-block; margin-top: 0.5rem;">URL List</a>
                        </p>
                        <small style="color: var(--text-secondary);">Text file with all download URLs for use with wget -i</small>
                    </div>
                    
                    <div class="stat-card">
                        <h3>üìÖ</h3>
                        <p style="color: var(--text-primary); font-size: 1rem; margin-top: 1rem;">
                            Download by Year
                        </p>
                        <small style="color: var(--text-secondary);">Get all nodelists from a specific year as tar.gz archive</small>
                        <div style="margin-top: 1rem;">
                            {{range .Years}}
                            <a href="/download/year/{{.Year}}.tar.gz" class="btn btn-sm" style="text-decoration: none; margin: 0.25rem;">{{.Year}}</a>
                            {{end}}
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-success" style="margin-top: 1.5rem;">
                    <strong>üí° Pro Tip:</strong> Use <code>wget -i nodelist-urls.txt</code> to download all files, or <code>wget -nc -i nodelist-urls.txt</code> to skip existing files.
                </div>
            </div>
            
            <div class="card">
                <h2 style="color: var(--text-primary); margin-bottom: 1.5rem;">üí° Usage Information</h2>
                
                <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">Direct Downloads</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    All nodelist files can be downloaded directly using the URL pattern:
                </p>
                <div style="background: #f8fafc; padding: 1rem; border-radius: var(--radius); margin-bottom: 1.5rem; font-family: monospace;">
                    /download/nodelist/{year}/{filename}
                </div>
                
                <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">Command Line Examples</h3>
                <div style="background: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: var(--radius); font-family: monospace;">
                    # Download latest nodelist<br>
                    wget {{.BaseURL}}/download/latest<br>
                    curl -O {{.BaseURL}}/download/latest<br><br>
                    
                    # Download specific nodelist<br>
                    wget {{.BaseURL}}/download/nodelist/2024/nodelist.365<br>
                    curl -O {{.BaseURL}}/download/nodelist/2024/nodelist.365
                </div>
            </div>
        </div>
        
        {{template "footer" .}}
    </div>
</body>
</html>