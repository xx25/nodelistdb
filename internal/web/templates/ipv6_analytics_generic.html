{{template "base" .}}

{{define "title"}}{{.Config.PageTitle}}{{end}}

{{define "page_title"}}{{.Config.PageTitle}}{{end}}

{{define "page_subtitle"}}{{.Config.PageSubtitle}}{{end}}

{{define "head_scripts"}}
<script src="/static/tooltip.js"></script>
<script src="/static/sortable-table.js"></script>
{{end}}

{{define "content"}}
{{template "analytics_filters" .}}
{{template "error_display" .}}

{{if .IPv6Nodes}}
<div class="stats-box">
    <h3>Found {{len .IPv6Nodes}} {{.Config.StatsHeading}} Nodes</h3>
</div>

<div class="table-responsive">
    <table class="data-table sortable-table">
        <thead>
            <tr>
                <th data-sortable data-type="address">Node Address</th>
                <th data-sortable data-type="string">Hostname</th>
                {{if eq .Config.TableLayout "dual-protocol"}}
                    <th data-sortable data-type="string">Working IPv4 Protocols</th>
                    <th data-sortable data-type="string">Failed IPv6 Protocols</th>
                {{else}}
                    <th data-sortable data-type="string">Protocols</th>
                {{end}}
                <th data-sortable data-type="string">Location</th>
                <th data-sortable data-type="date">Last Tested</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range .IPv6Nodes}}
            <tr>
                {{template "node_address_cell" .}}
                {{template "hostname_cell" .}}

                {{/* Render appropriate protocol columns based on config */}}
                {{if eq $.Config.TableLayout "dual-protocol"}}
                    {{template "ipv4_protocols_cell" .}}
                    {{template "ipv6_failed_protocols_cell" .}}
                {{else}}
                    {{template "ipv6_protocols_cell" .}}
                {{end}}

                {{template "location_cell" .}}
                {{template "timestamp_cell" .}}
                {{template "action_buttons_cell" .}}
            </tr>
            {{end}}
        </tbody>
    </table>
</div>

<div class="info-box" style="margin-top: 2rem;">
    {{range .ProcessedInfo}}
    <p>{{.}}</p>
    {{end}}
    <p><strong>Note about Location:</strong> The "Location" column shows the geographic location determined from the node's IP address (via GeoIP lookup), not the location specified in the nodelist. This represents the actual physical location where the node's server is hosted.</p>
</div>

{{else}}
<div class="alert alert-warning">
    <strong>{{.Config.EmptyStateTitle}}</strong><br>
    {{.Config.EmptyStateDesc}}
</div>
{{end}}
{{end}}
