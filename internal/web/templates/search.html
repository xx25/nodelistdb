<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>{{.Title}}</h1>
            <p class="subtitle">Find FidoNet nodes by address, system name, or location</p>
        </header>
        
        {{template "nav" .}}
        
        <div class="content">
            <div class="card">
                <form method="post" class="search-form">
                    <div class="form-group" style="grid-column: span 2;">
                        <label for="full_address">Full Node Address:</label>
                        <input type="text" id="full_address" name="full_address" placeholder="e.g. 2:5001/100 or 1:234/56.7" style="font-family: monospace;">
                        <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
                            üí° Enter complete address like "2:5001/100" or use individual fields below
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="zone">Zone:</label>
                        <select id="zone" name="zone">
                            <option value="">All Zones</option>
                            <option value="1">Zone 1 - United States and Canada</option>
                            <option value="2">Zone 2 - Europe, Former Soviet Union, and Israel</option>
                            <option value="3">Zone 3 - Australasia (includes former Zone 6 nodes)</option>
                            <option value="4">Zone 4 - Latin America (except Puerto Rico)</option>
                            <option value="5">Zone 5 - Africa</option>
                            <option value="6">Zone 6 - Asia (removed July 2007, nodes moved to Zone 3)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="net">Net:</label>
                        <input type="number" id="net" name="net" placeholder="e.g. 234" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="node">Node:</label>
                        <input type="number" id="node" name="node" placeholder="e.g. 56" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="system_name">System Name:</label>
                        <input type="text" id="system_name" name="system_name" placeholder="e.g. Example BBS">
                    </div>
                    
                    <div class="form-group">
                        <label for="location">Location:</label>
                        <input type="text" id="location" name="location" placeholder="e.g. New York, NY">
                    </div>
                    
                    <div class="form-group">
                        <label for="include_historical">
                            <input type="checkbox" id="include_historical" name="include_historical" value="1" checked>
                            Include historical data
                        </label>
                        <small style="color: var(--text-secondary); margin-top: 0.25rem; display: block;">
                            üìÖ Search all historical nodelists, not just the most recent
                        </small>
                    </div>
                    
                    <div class="form-group" style="align-self: end;">
                        <button type="submit" class="btn">üîç Search Nodes</button>
                    </div>
                </form>
                
                <div style="margin-top: 1rem; padding: 1rem; background: #f8fafc; border-radius: var(--radius); font-size: 0.9rem; color: var(--text-secondary);">
                    üí° <strong>Tip:</strong> You can search by any combination of fields. Leave fields empty to search more broadly.
                </div>
            </div>
            
            {{if .Error}}
                <div class="alert alert-error">
                    <strong>Error:</strong> {{.Error}}
                </div>
            {{end}}
            
            {{if .Nodes}}
                <div class="card">
                    <h2 style="color: var(--text-primary); margin-bottom: 1rem;">
                        Search Results 
                        <span class="badge badge-info" style="font-size: 0.8rem; margin-left: 0.5rem;">
                            {{.Count}} nodes found
                        </span>
                        {{if eq .Count 100}}
                            <span style="font-size: 0.7rem; color: var(--text-secondary); font-weight: normal; margin-left: 0.5rem;">
                                (limited to 100 results)
                            </span>
                        {{end}}
                    </h2>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Address</th>
                                    <th>System Name</th>
                                    <th>Location</th>
                                    <th>Sysop</th>
                                    <th>Active Period</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{range .Nodes}}
                                <tr>
                                    <td>
                                        <strong>
                                            <a href="/node/{{.Zone}}/{{.Net}}/{{.Node}}">{{.Zone}}:{{.Net}}/{{.Node}}</a>
                                        </strong>
                                    </td>
                                    <td>{{if .SystemName}}{{replaceUnderscores .SystemName}}{{else}}<em>-</em>{{end}}</td>
                                    <td>{{if .Location}}{{replaceUnderscores .Location}}{{else}}<em>-</em>{{end}}</td>
                                    <td>{{if .SysopName}}{{replaceUnderscores .SysopName}}{{else}}<em>-</em>{{end}}</td>
                                    <td style="font-size: 0.9rem; color: var(--text-secondary);">
                                        {{.FirstDate.Format "2006-01-02"}} - {{if .CurrentlyActive}}now{{else}}{{.LastDate.Format "2006-01-02"}}{{end}}
                                    </td>
                                    <td>
                                        {{if .CurrentlyActive}}
                                            <span class="badge badge-success">Active</span>
                                        {{else}}
                                            <span class="badge badge-historical">Historical</span>
                                        {{end}}
                                    </td>
                                    <td>
                                        <a href="/node/{{.Zone}}/{{.Net}}/{{.Node}}" class="btn btn-secondary" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">
                                            üìà History
                                        </a>
                                    </td>
                                </tr>
                                {{end}}
                            </tbody>
                        </table>
                    </div>
                </div>
            {{end}}
        </div>
        
        {{template "footer" .}}
    </div>
    <script src="/static/app.js"></script>
</body>
</html>